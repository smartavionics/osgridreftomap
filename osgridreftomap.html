<!DOCTYPE html>
<html lang="en">
<head>
<title>Convert from OS National Grid Reference points to WGS84</title>
<meta charset="utf-8"/>
<style type="text/css">
form  { max-width: 300px; }
input { font-size: 20px;}
input.keybutton { width: 60px; }
</style>
<script src="latlon.js">/* Latitude/Longitude formulae JavaScript implementation */</script>
<script src="geo.js">/*  */</script>
<script src="coordtransform.js">/*  */</script>
<script src="osgridref.js">/*  */</script>
<script src="jquery.min.js"></script>
<script>
$(document).ready(function() {
  $('#osgridref').change( function() {
    recalc();
  });
  $('#osgridref').focus();
  $('#osgridref').keypress(function(ev) {
    if(ev.which == 13) {
      ev.preventDefault();
      $('#showmap').focus();
    }
  });
});
function recalc() {
  var gr = $('#osgridref').val().split(" ");
  var gridref;
  if(gr.length == 2 && gr[0].length == 6 && gr[1].length == 6)
    gridref = new OsGridRef(gr[0], gr[1]);
  else if(gr.length == 1 && gr[0].length == 12)
    gridref = new OsGridRef(gr[0].substring(0, 6), gr[0].substring(6, 12));
  else {
    $('#WGS84').html("");
    $('#showmap').attr('disabled', true);
    /*console.log("invalid osgridref");*/
    return;
  }
  /*console.log("gridref", gridref);*/
  pOSGB = OsGridRef.osGridToLatLong(gridref);
  pWGS = CoordTransform.convertOSGB36toWGS84(pOSGB);
  WGS84LatLon = pWGS.lat().toFixed(8) + ',' + pWGS.lon().toFixed(8);
  $('#WGS84').html(WGS84LatLon);
  $('#showmap').attr('disabled', false);
}
function insert(n) {
  var field = $('#osgridref');
  field.val(field.val() + n);
  recalc();
}
function del() {
  var field = $('#osgridref');
  field.val(field.val().substring(0, field.val().length - 1));
  recalc();
}
function showMap() {
  window.open('http://maps.google.co.uk/?q=loc:' + WGS84LatLon + '&amp;ll=' + WGS84LatLon);
}
function navigateTo() {
  document.location='geo:' + WGS84LatLon;
}
</script>
</head>
<body>
<form>
<fieldset><legend>Convert OS Grid Ref to WGS84 Lat/Lon</legend>
<table>
<tr>
<td colspan="2">Input 12 digit grid ref or 2 x 6 digits</td>
</tr>
<!--
<tr>
<td>&nbsp;</td>
 <td><table>
   <tr>
   <td><input type="button" class="keybutton" value="1" onclick="insert(1)"/></td>
   <td><input type="button" class="keybutton" value="2" onclick="insert(2)"/></td>
   <td><input type="button" class="keybutton" value="3" onclick="insert(3)"/></td>
   </tr>
   <tr>
   <td><input type="button" class="keybutton" value="4" onclick="insert(4)"/></td>
   <td><input type="button" class="keybutton" value="5" onclick="insert(5)"/></td>
   <td><input type="button" class="keybutton" value="6" onclick="insert(6)"/></td>
   </tr>
   <tr>
   <td><input type="button" class="keybutton" value="7" onclick="insert(7)"/></td>
   <td><input type="button" class="keybutton" value="8" onclick="insert(8)"/></td>
   <td><input type="button" class="keybutton" value="9" onclick="insert(9)"/></td>
   </tr>
   <tr>
   <td><input type="button" class="keybutton" value="0" onclick="insert(0)"/></td>
   <td><input type="button" class="keybutton" value="SP" onclick="insert(' ')"/></td>
   <td><input type="button" class="keybutton" value="DEL" onclick="del()"/></td>
   </tr>
 </table>
 </td>
</tr>
-->
<tr>
<td colspan="2"><input name="osgridref" id="osgridref" onkeyup="recalc()"></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><b>WGS84</b></td> 
<td><output id="WGS84"></output></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td><input type="button" id="showmap" value="Show Map" onclick="showMap()" disabled="true"/></td>
</tr>
<!--
<tr>
<td colspan="2"><input type="button" id="navigateto" value="Navigate To" onclick="navigateTo()"/></td>
</tr>
-->
</table>
</fieldset>
</form>
<div style="max-width: 300px;">
<p>This utility is provided without any warranty of correctness or fitness for purpose. Use at your own risk.</p>
<p>Please send any feedback to <a href='mailto:burtoogle@gmail.com'>Mark Burton</a>.
<p>Many thanks to Chris Veness for writing the Javascript that does all the hard work (see <a href="http://www.movable-type.co.uk/scripts/latlong-gridref.html">Convert between Latitude/Longitude &amp; OS National Grid Reference points</a>).</p>
</div>
</body>
</html>

